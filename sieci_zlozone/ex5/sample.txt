Foundation models, now powering most of the exciting applications in deep learning, are almost universallybased on the Transformer architecture and its core attention module. Many subquadratic-time architecturessuch as linear attention, gated convolution and recurrent models, and structured state space models (SSMs)have been developed to address Transformers’ computational inefficiency on long sequences, but they have notperformed as well as attention on important modalities such as language. We identify that a key weakness ofsuch models is their inability to perform content-based reasoning, and make several improvements. First, simplyletting the SSM parameters be functions of the input addresses their weakness with discrete modalities, allowingthe model to selectively propagate or forget information along the sequence length dimension depending onthe current token. Second, even though this change prevents the use of efficient convolutions, we design ahardware-aware parallel algorithm in recurrent mode. We integrate these selective SSMs into a simplifiedend-to-end neural network architecture without attention or even MLP blocks (Mamba). Mamba enjoys fastinference (5× higher throughput than Transformers) and linear scaling in sequence length, and its performanceimproves on real data up to million-length sequences. As a general sequence model backbone, Mamba achievesstate-of-the-art performance across several modalities such as language, audio, and genomics. On languagemodeling, our Mamba-3B model outperforms Transformers of the same size and matches Transformers twiceits size, both in pretraining and downstream evaluation.
